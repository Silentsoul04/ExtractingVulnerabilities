CWE-611: Improper Restriction of XML External Entity Reference
Description
The software processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.
Extended Description
XML documents optionally contain a Document Type Definition (DTD), which, among other features, enables the definition of XML entities. It is possible to define an entity by providing a substitution string in the form of a URI. The XML parser can access the contents of this URI and embed these contents back into the XML document for further processing. By submitting an XML file that defines an external entity with a file:// URI, an attacker can cause the processing application to read the contents of a local file. For example, a URI such as "file:///c:/winnt/win.ini" designates (in Windows) the file C:\Winnt\win.ini, or file:///etc/passwd designates the password file in Unix-based systems. Using URIs with other schemes such as http://, the attacker can force the application to make outgoing requests to servers that the attacker cannot reach directly, which can be used to bypass firewall restrictions or hide the source of attacks such as port scanning. Once the content of the URI is read, it is fed back into the application that is processing the XML. This application may echo back the data (e.g. in an error message), thereby exposing the file contents.
Alternate Terms
XXE: XXE is an acronym used for the term "XML eXternal Entities"
XXE is an acronym used for the term "XML eXternal Entities"
Relationships
The table(s) below shows the weaknesses and high level categories that are related to this weakness. These relationships are defined as ChildOf, ParentOf, MemberOf and give insight to similar items that may exist at higher and lower levels of abstraction. In addition, relationships such as PeerOf and CanAlsoBe are defined to show similar weaknesses that the user may want to explore. Relevant to the view "Research Concepts" (CWE-1000) Nature Type ID Name ChildOf Class - a weakness that is described in a very abstract fashion, typically independent of any specific language or technology. More specific than a Pillar Weakness, but more general than a Base Weakness. Class level weaknesses typically describe issues in terms of 1 or 2 of the following dimensions: behavior, property, and resource. 610 Externally Controlled Reference to a Resource in Another Sphere PeerOf Class - a weakness that is described in a very abstract fashion, typically independent of any specific language or technology. More specific than a Pillar Weakness, but more general than a Base Weakness. Class level weaknesses typically describe issues in terms of 1 or 2 of the following dimensions: behavior, property, and resource. 441 Unintended Proxy or Intermediary ('Confused Deputy') Relevant to the view "Software Development" (CWE-699) Nature Type ID Name MemberOf Category - a CWE entry that contains a set of other entries that share a common characteristic. 19 Data Processing Errors Relevant to the view "Weaknesses for Simplified Mapping of Published Vulnerabilities" (CWE-1003) Nature Type ID Name ChildOf Class - a weakness that is described in a very abstract fashion, typically independent of any specific language or technology. More specific than a Pillar Weakness, but more general than a Base Weakness. Class level weaknesses typically describe issues in terms of 1 or 2 of the following dimensions: behavior, property, and resource. 610 Externally Controlled Reference to a Resource in Another Sphere Relevant to the view "Architectural Concepts" (CWE-1008) Nature Type ID Name MemberOf Category - a CWE entry that contains a set of other entries that share a common characteristic. 1015 Limit Access
Nature Type ID Name ChildOf Class - a weakness that is described in a very abstract fashion, typically independent of any specific language or technology. More specific than a Pillar Weakness, but more general than a Base Weakness. Class level weaknesses typically describe issues in terms of 1 or 2 of the following dimensions: behavior, property, and resource. 610 Externally Controlled Reference to a Resource in Another Sphere PeerOf Class - a weakness that is described in a very abstract fashion, typically independent of any specific language or technology. More specific than a Pillar Weakness, but more general than a Base Weakness. Class level weaknesses typically describe issues in terms of 1 or 2 of the following dimensions: behavior, property, and resource. 441 Unintended Proxy or Intermediary ('Confused Deputy')
Nature Type ID Name MemberOf Category - a CWE entry that contains a set of other entries that share a common characteristic. 19 Data Processing Errors
Nature Type ID Name ChildOf Class - a weakness that is described in a very abstract fashion, typically independent of any specific language or technology. More specific than a Pillar Weakness, but more general than a Base Weakness. Class level weaknesses typically describe issues in terms of 1 or 2 of the following dimensions: behavior, property, and resource. 610 Externally Controlled Reference to a Resource in Another Sphere
Nature Type ID Name MemberOf Category - a CWE entry that contains a set of other entries that share a common characteristic. 1015 Limit Access
Modes Of Introduction
The different Modes of Introduction provide information about how and when this weakness may be introduced. The Phase identifies a point in the life cycle at which introduction may occur, while the Note provides a typical scenario related to introduction during the given phase. Phase Note Implementation REALIZATION: This weakness is caused during implementation of an architectural security tactic.
Applicable Platforms
The listings below show possible areas for which the given weakness could appear. These may be for specific named Languages, Operating Systems, Architectures, Paradigms, Technologies, or a class of such platforms. The platform is listed along with how frequently the given weakness appears for that instance. Languages XML (Undetermined Prevalence) Technologies Class: Web Based (Undetermined Prevalence)
XML (Undetermined Prevalence)
Class: Web Based (Undetermined Prevalence)
Common Consequences
The table below specifies different individual consequences associated with the weakness. The Scope identifies the application security area that is violated, while the Impact describes the negative technical impact that arises if an adversary succeeds in exploiting this weakness. The Likelihood provides information about how likely the specific consequence is expected to be seen relative to the other consequences in the list. For example, there may be high likelihood that a weakness will be exploited to achieve a certain impact, but a low likelihood that it will be exploited to achieve a different impact. Scope Impact Likelihood Confidentiality Technical Impact: Read Application Data; Read Files or Directories If the attacker is able to include a crafted DTD and a default entity resolver is enabled, the attacker may be able to access arbitrary files on the system. Integrity Technical Impact: Bypass Protection Mechanism The DTD may include arbitrary HTTP requests that the server may execute. This could lead to other attacks leveraging the server's trust relationship with other entities. Availability Technical Impact: DoS: Resource Consumption (CPU); DoS: Resource Consumption (Memory) The software could consume excessive CPU cycles or memory using a URI that points to a large file, or a device that always returns data such as /dev/random. Alternately, the URI could reference a file that contains many nested or recursive entity references to further slow down parsing.
Observed Examples
Reference Description CVE-2005-1306 A browser control can allow remote attackers to determine the existence of files via Javascript containing XML script. CVE-2012-5656 XXE during SVG image conversion CVE-2012-2239 XXE in PHP application allows reading the application's configuration file. CVE-2012-3489 XXE in database server CVE-2012-4399 XXE in rapid web application development framework allows reading arbitrary files. CVE-2012-3363 XXE via XML-RPC request. CVE-2012-0037 XXE in office document product using RDF. CVE-2011-4107 XXE in web-based administration tool for database. CVE-2010-3322 XXE in product that performs large-scale data analysis. CVE-2009-1699 XXE in XSL stylesheet functionality in a common library used by some web browsers.
A browser control can allow remote attackers to determine the existence of files via Javascript containing XML script.
XXE during SVG image conversion
XXE in PHP application allows reading the application's configuration file.
XXE in database server
XXE in rapid web application development framework allows reading arbitrary files.
XXE via XML-RPC request.
XXE in office document product using RDF.
XXE in web-based administration tool for database.
XXE in product that performs large-scale data analysis.
XXE in XSL stylesheet functionality in a common library used by some web browsers.
Potential Mitigations
Phases: Implementation; System Configuration Many XML parsers and validators can be configured to disable external entity expansion.
Many XML parsers and validators can be configured to disable external entity expansion.
Memberships
This MemberOf Relationships table shows additional CWE Categories and Views that reference this weakness as a member. This information is often useful in understanding where a weakness fits within the context of external information sources. Nature Type ID Name MemberOf Category - a CWE entry that contains a set of other entries that share a common characteristic. 990 SFP Secondary Cluster: Tainted Input to Command MemberOf Category - a CWE entry that contains a set of other entries that share a common characteristic. 1030 OWASP Top Ten 2017 Category A4 - XML External Entities (XXE) MemberOf View - a subset of CWE entries that provides a way of examining CWE content. The two main view structures are Slices (flat lists) and Graphs (containing relationships between entries). 1200 Weaknesses in the 2019 CWE Top 25 Most Dangerous Software Errors MemberOf Category - a CWE entry that contains a set of other entries that share a common characteristic. 1308 CISQ Quality Measures - Security MemberOf View - a subset of CWE entries that provides a way of examining CWE content. The two main view structures are Slices (flat lists) and Graphs (containing relationships between entries). 1350 Weaknesses in the 2020 CWE Top 25 Most Dangerous Software Weaknesses
Notes
Relationship CWE-918 (SSRF) and CWE-611 (XXE) are closely related, because they both involve web-related technologies and can launch outbound requests to unexpected destinations. However, XXE can be performed client-side, or in other contexts in which the software is not acting directly as a server, so the "Server" portion of the SSRF acronym does not necessarily apply.
CWE-918 (SSRF) and CWE-611 (XXE) are closely related, because they both involve web-related technologies and can launch outbound requests to unexpected destinations. However, XXE can be performed client-side, or in other contexts in which the software is not acting directly as a server, so the "Server" portion of the SSRF acronym does not necessarily apply.
Taxonomy Mappings
Mapped Taxonomy Name Node ID Fit Mapped Node Name WASC 43 XML External Entities Software Fault Patterns SFP24 Tainted input to command
Related Attack Patterns
CAPEC-ID Attack Pattern Name CAPEC-221 Data Serialization External Entities Blowup
References
[REF-496] OWASP. "XML External Entity (XXE) Processing". <https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing>. [REF-497] Sascha Herzog. "XML External Entity Attacks (XXE)". 2010-10-20. <https://www.owasp.org/images/5/5d/XML_Exteral_Entity_Attack.pdf>. [REF-498] Gregory Steuck. "XXE (Xml eXternal Entity) Attack". <http://www.securiteam.com/securitynews/6D0100A5PU.html>. [REF-499] WASC. "XML External Entities (XXE) Attack". <http://projects.webappsec.org/w/page/13247003/XML%20External%20Entities>. [REF-500] Bryan Sullivan. "XML Denial of Service Attacks and Defenses". 2009-09. <http://msdn.microsoft.com/en-us/magazine/ee335713.aspx>. [REF-501] Chris Cornutt. "Preventing XXE in PHP". <http://websec.io/2012/08/27/Preventing-XXE-in-PHP.html>.
Content History
Submissions Submission Date Submitter Organization 2007-05-07 Anonymous Tool Vendor (under NDA) Modifications Modification Date Modifier Organization 2008-07-01 Eric Dalci Cigital updated Time_of_Introduction 2008-09-08 CWE Content Team MITRE updated Description, Relationships, Observed_Example, Other_Notes, Taxonomy_Mappings 2010-02-16 CWE Content Team MITRE updated Taxonomy_Mappings 2010-09-27 CWE Content Team MITRE updated Background_Details, Other_Notes 2011-03-29 CWE Content Team MITRE updated Name 2011-06-01 CWE Content Team MITRE updated Common_Consequences 2012-05-11 CWE Content Team MITRE updated Relationships 2013-02-21 CWE Content Team MITRE updated Alternate_Terms, Applicable_Platforms, Background_Details, Common_Consequences, Description, Name, Observed_Examples, Potential_Mitigations, References, Relationship_Notes, Relationships, Taxonomy_Mappings 2014-07-30 CWE Content Team MITRE updated Relationships, Taxonomy_Mappings 2015-12-07 CWE Content Team MITRE updated Relationships 2017-11-08 CWE Content Team MITRE updated Modes_of_Introduction, References, Relationships, Relevant_Properties 2018-03-27 CWE Content Team MITRE updated Relationships 2019-01-03 CWE Content Team MITRE updated Related_Attack_Patterns 2019-06-20 CWE Content Team MITRE updated Name, Type 2019-09-19 CWE Content Team MITRE updated Relationships 2020-02-24 CWE Content Team MITRE updated Applicable_Platforms, Relationships 2020-08-20 CWE Content Team MITRE updated Relationships Previous Entry Names Change Date Previous Entry Name 2011-03-29 Information Leak Through XML External Entity File Disclosure 2013-02-21 Information Exposure Through XML External Entity Reference 2019-06-20 Improper Restriction of XML External Entity Reference ('XXE')


